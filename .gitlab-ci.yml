# Painless deployment with GitLab CI.
# Visit the docs at https://docs.gitlab.com/ce/ci/

image: painless/tox:multi

stages:
- check
- test
- build
- deploy

flake8:
  stage: check
  script: tox -e flake8

pylint:
  stage: check
  script: tox -e pylint

bandit:
  stage: check
  script: tox -e bandit
  allow_failure: true

py35:
  stage: test
  script: tox -e py35

py36:
  stage: test
  script: tox -e py36

py37:
  stage: test
  script: tox -e py37

pypy3:
  stage: test
  script: tox -e pypy3

behave:
  stage: test
  script: tox -e behave

build:
  stage: build
  script:
  - echo 'This build would build a Docker image and push it to the registry.'
  only:
  - feature/*

staging:
  stage: deploy
  script:
  - echo 'This build would deploy to Staging now.'
  only:
  - master

production:
  stage: deploy
  script:
  - echo 'This build would deploy to Production now.'
  only:
  - tags
